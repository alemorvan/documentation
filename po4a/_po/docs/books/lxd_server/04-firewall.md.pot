# SOME DESCRIPTIVE TITLE
# Copyright (C) YEAR Free Software Foundation, Inc.
# This file is distributed under the same license as the PACKAGE package.
# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: PACKAGE VERSION\n"
"POT-Creation-Date: 2023-06-11 15:28+0000\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <LL@li.org>\n"
"Language: \n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"

#. type: YAML Front Matter: tags
#: ../src/docs/books/lxd_server/04-firewall.md:1
#, no-wrap
msgid "lxd"
msgstr ""

#. type: YAML Front Matter: tags
#: ../src/docs/books/lxd_server/04-firewall.md:1
#, no-wrap
msgid "enterprise"
msgstr ""

#. type: YAML Front Matter: tags
#: ../src/docs/books/lxd_server/04-firewall.md:1
#, no-wrap
msgid "lxd security"
msgstr ""

#. type: YAML Front Matter: title
#: ../src/docs/books/lxd_server/04-firewall.md:1
#, no-wrap
msgid "4 Firewall Setup"
msgstr ""

#. type: Title #
#: ../src/docs/books/lxd_server/04-firewall.md:12
#, no-wrap
msgid "Chapter 4: Firewall Setup"
msgstr ""

#. type: Plain text
#: ../src/docs/books/lxd_server/04-firewall.md:15
msgid ""
"Throughout this chapter you will need to be root or able to `sudo` to become "
"root."
msgstr ""

#. type: Plain text
#: ../src/docs/books/lxd_server/04-firewall.md:17
msgid ""
"As with any server, you need to make sure that it is secured from the "
"outside world and on your LAN. While our example server only has a LAN "
"interface, it is totally possible to have two interfaces, one each facing "
"your LAN and WAN networks. While we cover `iptables` rules in this "
"procedure, we **highly** recommend using the `firewalld` procedure instead "
"(see the note below)."
msgstr ""

#. type: Title ##
#: ../src/docs/books/lxd_server/04-firewall.md:18
#, no-wrap
msgid "Firewall Set Up - iptables"
msgstr ""

#. type: Plain text
#: ../src/docs/books/lxd_server/04-firewall.md:21
msgid "!!! note \"A note regarding Rocky Linux 9.0\""
msgstr ""

#. type: Plain text
#: ../src/docs/books/lxd_server/04-firewall.md:23
#, no-wrap
msgid "    Starting with Rocky Linux 9.0, `iptables` and all of the associated utilities are officially deprecated. This means that in future versions of the OS, perhaps as early as 9.1, they will disappear altogether. For this reason, you should skip down to the `firewalld` procedure below before continuing.\n"
msgstr ""

#. type: Plain text
#: ../src/docs/books/lxd_server/04-firewall.md:25
#, no-wrap
msgid "    It's actually a good idea to use `firewalld` for Rocky Linux 8.6 as well, but we *do* offer you the option of using `iptables` if you really want it.\n"
msgstr ""

#. type: Plain text
#: ../src/docs/books/lxd_server/04-firewall.md:27
msgid ""
"Before continuing, you will want a firewall set up on your server. This "
"example is using _iptables_ and [this procedure](../../guides/security/"
"enabling_iptables_firewall.md) to disable _firewalld_. If you prefer to use "
"_firewalld_, simply substitute in _firewalld_ rules using the instructions "
"below this section."
msgstr ""

#. type: Plain text
#: ../src/docs/books/lxd_server/04-firewall.md:29
msgid "Create your firewall.conf script:"
msgstr ""

#. type: Fenced code block
#: ../src/docs/books/lxd_server/04-firewall.md:30
#, no-wrap
msgid "vi /etc/firewall.conf\n"
msgstr ""

#. type: Plain text
#: ../src/docs/books/lxd_server/04-firewall.md:35
msgid ""
"We are assuming an LXD server on a LAN network of 192.168.1.0/24 below. "
"Note, too, that we are accepting all traffic from our bridged interface. "
"This is important if you want your containers to get IP addresses from the "
"bridge."
msgstr ""

#. type: Plain text
#: ../src/docs/books/lxd_server/04-firewall.md:37
msgid ""
"This firewall script makes no other assumptions about the network services "
"needed. There is an SSH rule to allow our LAN network IP's to SSH into the "
"server. You can very easily have many more rules needed here, depending on "
"your environment. Later, we will be adding a rule for bi-directional traffic "
"between our production server and the snapshot server."
msgstr ""

#. type: Fenced code block
#: ../src/docs/books/lxd_server/04-firewall.md:38
#, no-wrap
msgid ""
"#!/bin/sh\n"
"#\n"
"#IPTABLES=/usr/sbin/iptables\n"
"\n"
"#  Unless specified, the defaults for OUTPUT is ACCEPT\n"
"#    The default for FORWARD and INPUT is DROP\n"
"#\n"
"echo \"   clearing any existing rules and setting default policy..\"\n"
"iptables -F INPUT\n"
"iptables -P INPUT DROP\n"
"iptables -A INPUT -i lxdbr0 -j ACCEPT\n"
"iptables -A INPUT -p tcp -m tcp -s 192.168.1.0/24 --dport 22 -j ACCEPT\n"
"iptables -A INPUT -i lo -j ACCEPT\n"
"iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\n"
"iptables -A INPUT -p tcp -j REJECT --reject-with tcp-reset\n"
"iptables -A INPUT -p udp -j REJECT --reject-with icmp-port-unreachable\n"
"\n"
"/usr/sbin/service iptables save\n"
msgstr ""

#. type: Title ##
#: ../src/docs/books/lxd_server/04-firewall.md:59
#, no-wrap
msgid "Firewall Set Up - firewalld"
msgstr ""

#. type: Plain text
#: ../src/docs/books/lxd_server/04-firewall.md:62
msgid ""
"For _firewalld_ rules, we need to use [this basic procedure](../../guides/"
"security/firewalld.md) or be familiar with those concepts. Our assumptions "
"are the same as with the _iptables_ rules above: LAN network of "
"192.168.1.0/24 and a bridge named lxdbr0. To be clear, you might have "
"multiple interfaces on your LXD server, with one perhaps facing your WAN as "
"well. We are also going to create a zone for the bridged and local networks. "
"This is just for zone clarity sake, as the other names do not really apply. "
"The below assumes that you already know the basics of _firewalld_."
msgstr ""

#. type: Fenced code block
#: ../src/docs/books/lxd_server/04-firewall.md:63
#, no-wrap
msgid "firewall-cmd --new-zone=bridge --permanent\n"
msgstr ""

#. type: Plain text
#: ../src/docs/books/lxd_server/04-firewall.md:68
msgid "You need to reload the firewall after adding a zone:"
msgstr ""

#. type: Fenced code block
#: ../src/docs/books/lxd_server/04-firewall.md:69
#: ../src/docs/books/lxd_server/04-firewall.md:89
#, no-wrap
msgid "firewall-cmd --reload\n"
msgstr ""

#. type: Plain text
#: ../src/docs/books/lxd_server/04-firewall.md:74
msgid ""
"We want to allow all traffic from the bridge, so let's just add the "
"interface, and then change the target from \"default\" to \"ACCEPT\" and we "
"will be done:"
msgstr ""

#. type: Plain text
#: ../src/docs/books/lxd_server/04-firewall.md:76
msgid "!!! warning"
msgstr ""

#. type: Plain text
#: ../src/docs/books/lxd_server/04-firewall.md:78
#, no-wrap
msgid "    Changing the target of a firewalld zone *must* be done with the --permanent option, so we might as well just enter that flag in our other commands as well and forgo the --runtime-to-permanent option.\n"
msgstr ""

#. type: Plain text
#: ../src/docs/books/lxd_server/04-firewall.md:80
msgid "!!! Note"
msgstr ""

#. type: Plain text
#: ../src/docs/books/lxd_server/04-firewall.md:82
#, no-wrap
msgid "    If you need to create a zone that you want to allow all access to the interface or source, but do not want to have to specify any protocols or services, then you *must* change the target from \"default\" to ACCEPT. The same is true of DROP and REJECT for a particular IP block that you have custom zones for. To be clear, the \"drop\" zone will take care of that for you as long as you aren't using a custom zone.\n"
msgstr ""

#. type: Fenced code block
#: ../src/docs/books/lxd_server/04-firewall.md:83
#, no-wrap
msgid ""
"firewall-cmd --zone=bridge --add-interface=lxdbr0 --permanent\n"
"firewall-cmd --zone=bridge --set-target=ACCEPT --permanent\n"
msgstr ""

#. type: Plain text
#: ../src/docs/books/lxd_server/04-firewall.md:88
msgid "Assuming no errors and everything is still working just do a reload:"
msgstr ""

#. type: Plain text
#: ../src/docs/books/lxd_server/04-firewall.md:93
msgid ""
"If you list out your rules now with `firewall-cmd --zone=bridge --list-all` "
"you should see something like the following:"
msgstr ""

#. type: Fenced code block
#: ../src/docs/books/lxd_server/04-firewall.md:94
#, no-wrap
msgid ""
"bridge (active)\n"
"  target: ACCEPT\n"
"  icmp-block-inversion: no\n"
"  interfaces: lxdbr0\n"
"  sources:\n"
"  services:\n"
"  ports:\n"
"  protocols:\n"
"  forward: no\n"
"  masquerade: no\n"
"  forward-ports:\n"
"  source-ports:\n"
"  icmp-blocks:\n"
"  rich rules:\n"
msgstr ""

#. type: Plain text
#: ../src/docs/books/lxd_server/04-firewall.md:111
msgid ""
"Note from the _iptables_ rules, that we also want to allow our local "
"interface. Again, I do not like the included zones for this, so create a new "
"zone and use the source IP range for the local interface to make sure you "
"have access:"
msgstr ""

#. type: Fenced code block
#: ../src/docs/books/lxd_server/04-firewall.md:112
#, no-wrap
msgid ""
"firewall-cmd --new-zone=local --permanent\n"
"firewall-cmd --reload\n"
msgstr ""

#. type: Plain text
#: ../src/docs/books/lxd_server/04-firewall.md:117
msgid ""
"Then we just need to add the source IP's for the local interface, change the "
"target to \"ACCEPT\" and we are done with this as well:"
msgstr ""

#. type: Fenced code block
#: ../src/docs/books/lxd_server/04-firewall.md:118
#, no-wrap
msgid ""
"firewall-cmd --zone=local --add-source=127.0.0.1/8 --permanent\n"
"firewall-cmd --zone=local --set-target=ACCEPT --permanent\n"
"firewall-cmd --reload\n"
msgstr ""

#. type: Plain text
#: ../src/docs/books/lxd_server/04-firewall.md:124
msgid ""
"Go ahead and list out the \"local\" zone to make sure your rules are there "
"with `firewall-cmd --zone=local --list all` which should show you something "
"like this:"
msgstr ""

#. type: Fenced code block
#: ../src/docs/books/lxd_server/04-firewall.md:125
#, no-wrap
msgid ""
"local (active)\n"
"  target: ACCEPT\n"
"  icmp-block-inversion: no\n"
"  interfaces:\n"
"  sources: 127.0.0.1/8\n"
"  services:\n"
"  ports:\n"
"  protocols:\n"
"  forward: no\n"
"  masquerade: no\n"
"  forward-ports:\n"
"  source-ports:\n"
"  icmp-blocks:\n"
"  rich rules:\n"
msgstr ""

#. type: Plain text
#: ../src/docs/books/lxd_server/04-firewall.md:143
msgid ""
"Next we want to allow SSH from our trusted network. We will use the source "
"IP's here, just like in our _iptables_ example, and the built-in \"trusted\" "
"zone. The target for this zone is already \"ACCEPT\" by default."
msgstr ""

#. type: Fenced code block
#: ../src/docs/books/lxd_server/04-firewall.md:144
#, no-wrap
msgid "firewall-cmd --zone=trusted --add-source=192.168.1.0/24\n"
msgstr ""

#. type: Plain text
#: ../src/docs/books/lxd_server/04-firewall.md:148
msgid "Then add the service to the zone:"
msgstr ""

#. type: Fenced code block
#: ../src/docs/books/lxd_server/04-firewall.md:149
#, no-wrap
msgid "firewall-cmd --zone=trusted --add-service=ssh\n"
msgstr ""

#. type: Plain text
#: ../src/docs/books/lxd_server/04-firewall.md:153
msgid ""
"And if everything is working, move your rules to permanent and reload the "
"rules:"
msgstr ""

#. type: Fenced code block
#: ../src/docs/books/lxd_server/04-firewall.md:154
#, no-wrap
msgid ""
"firewall-cmd --runtime-to-permanent\n"
"firewall-cmd --reload\n"
msgstr ""

#. type: Plain text
#: ../src/docs/books/lxd_server/04-firewall.md:159
msgid ""
"Listing out your \"trusted\" zone should now show you something like this:"
msgstr ""

#. type: Fenced code block
#: ../src/docs/books/lxd_server/04-firewall.md:160
#, no-wrap
msgid ""
"trusted (active)\n"
"  target: ACCEPT\n"
"  icmp-block-inversion: no\n"
"  interfaces:\n"
"  sources: 192.168.1.0/24\n"
"  services: ssh\n"
"  ports:\n"
"  protocols:\n"
"  forward: no\n"
"  masquerade: no\n"
"  forward-ports:\n"
"  source-ports:\n"
"  icmp-blocks:\n"
"  rich rules:\n"
msgstr ""

#. type: Plain text
#: ../src/docs/books/lxd_server/04-firewall.md:178
msgid ""
"By default, the \"public\" zone is enabled and has SSH allowed. We don't "
"want this. Make sure that your zones are correct and that the access you are "
"getting to the server is via one of the LAN IP's (in the case of our "
"example) and is allowed to SSH. You could lock yourself out of the server if "
"you don't verify this before continuing. Once you've made sure you have "
"access from the correct interface, remove SSH from the \"public\" zone:"
msgstr ""

#. type: Fenced code block
#: ../src/docs/books/lxd_server/04-firewall.md:179
#, no-wrap
msgid "firewall-cmd --zone=public --remove-service=ssh\n"
msgstr ""

#. type: Plain text
#: ../src/docs/books/lxd_server/04-firewall.md:184
msgid ""
"Test access and make sure you aren't locked out. If not, then move your "
"rules to permanent, reload, and list out zone \"public\" to be sure that SSH "
"is removed:"
msgstr ""

#. type: Fenced code block
#: ../src/docs/books/lxd_server/04-firewall.md:185
#, no-wrap
msgid ""
"firewall-cmd --runtime-to-permanent\n"
"firewall-cmd --reload\n"
"firewall-cmd --zone=public --list-all\n"
msgstr ""

#. type: Plain text
#: ../src/docs/books/lxd_server/04-firewall.md:191
msgid ""
"There may be other interfaces on your server to consider. You can use built-"
"in zones where appropriate, but if you don't like the names (they don't "
"appear logical, etc.), you can definitely add zones. Just remember that if "
"you have no services or protocols that you need to allow or reject "
"specifically, then you will need to modify the zone target. If it works to "
"use interfaces, as we've done with the bridge, you can do that. If you need "
"more granular access to services, uses source IP's instead."
msgstr ""
